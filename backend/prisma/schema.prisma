generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id            Int      @id @default(autoincrement())
  email         String   @unique
  password      String
  role          String
  nombre        String
  especialidad  String?
  createdAt     DateTime @default(now())

  turnosCliente  Turno[] @relation("TurnosCliente")
  turnosEmpleado Turno[] @relation("TurnosEmpleado")
}

model Servicio {
  id           Int       @id @default(autoincrement())
  nombre       String
  descripcion  String
  precio       Float
  duracion     Int
  especialidad String?
  turnos       Turno[]
}

model Producto {
  id          Int              @id @default(autoincrement())
  nombre      String
  descripcion String?
  precio      Float
  stock       Int
  marca       String?
  categoria   String?
  imagen      String?
  createdAt   DateTime         @default(now())

  turnos      TurnoProducto[]  // relación con los turnos
}

model Turno {
  id          Int              @id @default(autoincrement())
  fechaHora   DateTime
  estado      String            @default("disponible")

  cliente     User?             @relation("TurnosCliente", fields: [clienteId], references: [id])
  clienteId   Int?

  empleado    User              @relation("TurnosEmpleado", fields: [empleadoId], references: [id])
  empleadoId  Int

  servicio    Servicio          @relation(fields: [servicioId], references: [id])
  servicioId  Int

  productos   TurnoProducto[]   // relación con productos (opcional)
  createdAt   DateTime          @default(now())
}

model TurnoProducto {
  id          Int       @id @default(autoincrement())
  turno       Turno     @relation(fields: [turnoId], references: [id])
  turnoId     Int
  producto    Producto  @relation(fields: [productoId], references: [id])
  productoId  Int
  cantidad    Int
}